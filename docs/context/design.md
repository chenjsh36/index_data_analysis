# 纳斯达克指数短线波段交易（3-10天）RSI策略设计思路
## 一、核心定位与边界界定（金融+技术双维度）
### 1. 交易风格锚定
+ **持仓周期**：3-10天（短线波段核心），不参与日内超短线（1分钟/5分钟K线仅作辅助验证）；
+ **核心指标组合**：9日RSI（短期）+24日RSI（长期）为主，50日均线（趋势）+成交量（动能）为验证维度；
+ **核心K线周期**：日线（主决策）+30分钟K线（择时细化）；
+ **适用标的**：QQQ（纳指ETF）、TQQQ（3倍杠杆纳指ETF）等流动性充足的纳指相关标的；
+ **市场环境边界**：排除极端行情（VIX>30且RSI<10/RSI>90），禁止逆势操作。

### 2. 核心目标
将文档中「定性的RSI实操规则」转化为「量化可执行的交易逻辑」，实现“趋势定方向+量能验真假+RSI找点位”的闭环，核心追求：胜率≥62%（文档回测基准）、盈亏比≥1.5、最大回撤≤15%。

## 二、数据层设计（程序员核心）
### 1. 数据源与数据维度
| 数据类型 | 所需字段 | 数据频率 | 数据源要求 |
| --- | --- | --- | --- |
| 价格数据 | 日期、开盘价、收盘价、最高价、最低价、复权因子 | 日线+30分钟线 | 需复权（前复权），无数据缺失 |
| 成交量数据 | 当日成交量、20日均量（滚动计算） | 日线+30分钟线 | 需剔除异常成交量（如停牌后） |
| 辅助指标数据 | VIX恐慌指数、纳指前5大权重股价格/成交量 | 日线 | 实时更新，延迟≤1分钟 |


### 2. 数据清洗与预处理（量化基础）
+ **价格清洗**：剔除停牌、除权除息导致的价格跳空，用前复权价计算RSI/均线（避免价格失真）；
+ **成交量标准化**：计算「当日成交量/近20日均量」的比值（文档核心的“相对量能”），过滤单日极端放量（比值>3倍视为异常，替换为20日均量）；
+ **指标预计算**：提前离线计算9/24日RSI、50日均线（收盘价计算）、均线斜率（50日均线近5日的涨跌幅度，判断趋势方向）。

### 3. 数据存储方案
+ 离线数据：用时序数据库（InfluxDB/TimescaleDB）存储历史数据（至少覆盖2018-2025年，含一轮牛熊周期）；
+ 实时数据：用Redis缓存当日30分钟/日线数据，更新频率≤5分钟（适配短线择时）。

## 三、规则层设计（金融逻辑转量化规则）
将文档中定性的交易规则转化为「可判定、可计算」的量化规则，核心分4个子规则集：

### 1. 趋势判定规则（50日均线+收盘价）
| 趋势类型 | 量化判定条件 |
| --- | --- |
| 上升趋势 | 50日均线斜率>0（近5日上涨）且连续2日收盘价≥50日均线（允许日内刺破，收盘价有效） |
| 下降趋势 | 50日均线斜率<0（近5日下跌）且连续2日收盘价≤50日均线 |
| 震荡趋势 | 50日均线斜率∈[-0.5%, 0.5%]且收盘价在50日均线±3%区间波动≥5个交易日 |


### 2. 量能验证规则（相对成交量）
| 量能类型 | 量化判定条件 | 金融意义 |
| --- | --- | --- |
| 有效放量 | 当日成交量 ≥ 近20日均量 × 1.2 | 资金主动推动，信号有效 |
| 巨量 | 当日成交量 ≥ 近20日均量 × 1.5 | 趋势可能见顶/见底 |
| 有效缩量 | 当日成交量 ≤ 近20日均量 × 0.8 | 资金惜售/抛压衰竭 |
| 地量 | 当日成交量 ≤ 近20日均量 × 0.5 | 趋势即将反转 |


### 3. RSI核心规则（9/24日周期）
#### （1）超买超卖阈值（分市场环境）
| 市场环境 | 超买阈值 | 强超买 | 超卖阈值 | 强超卖 |
| --- | --- | --- | --- | --- |
| 震荡市 | 70 | 75 | 30 | 25 |
| 牛市（上升） | 80 | 85 | 40 | 35 |
| 熊市（下降） | 60 | 65 | 20 | 15 |


#### （2）背离量化判定（日线级别，核心反转信号）
+ **顶背离**：  
① 价格创2个新高（H1 < H2，间隔≥5个交易日）；  
② 对应RSI高点（RSI1 > RSI2）；  
③ 成交量同步缩量（H2对应的成交量 < H1对应的成交量）；  
④ 前5大权重股至少3只同步顶背离。
+ **底背离**：  
① 价格创2个新低（L1 > L2，间隔≥5个交易日）；  
② 对应RSI低点（RSI1 < RSI2）；  
③ 成交量同步放量（L2对应的成交量 > L1对应的成交量）；  
④ 前5大权重股至少3只同步底背离。

#### （3）金叉/死叉量化判定
+ **有效金叉**：  
① 9日RSI上穿24日RSI（交叉点差值≤2）；  
② 交叉位置：震荡市30-50区间/牛市40-60区间/熊市30-50区间；  
③ 交叉后1个交易日内价格站上5日均线；  
④ 交叉当日成交量≥1.2倍20日均量。
+ **有效死叉**：  
① 9日RSI下穿24日RSI（交叉点差值≤2）；  
② 交叉位置：震荡市50-70区间/牛市50-70区间/熊市40-60区间；  
③ 交叉后1个交易日内价格跌破5日均线；  
④ 交叉当日成交量≥1.2倍20日均量。

### 4. 多条件组合规则（过滤假信号）
所有RSI信号需满足「趋势+量能」双重验证，优先级：趋势>量能>RSI，即：

+ 上升趋势：只验证买入/持仓信号，忽略超买信号（除非缩量滞涨）；
+ 下降趋势：只验证卖出/空仓信号，忽略超卖信号（除非缩量企稳）；
+ 震荡趋势：仅执行超买超卖的高抛低吸，金叉死叉需量能验证。

## 四、信号层设计（买入/卖出/止损止盈）
### 1. 买入信号（优先级从高到低）
| 信号类型 | 触发条件 | 仓位建议 |
| --- | --- | --- |
| 底背离确认 | 满足底背离量化规则 + 50日均线趋势向下但斜率收窄（>-0.5%） | 30%（首次）→50%（二次确认：价格破前低压力） |
| 有效金叉 | 满足有效金叉规则 + 对应趋势验证 | 40% |
| 超卖反弹 | RSI触及对应超卖阈值 + 缩量企稳（有效缩量）+ 价格未破50日均线下方3% | 30% |
| 趋势回踩加仓 | 上升趋势中RSI回踩45-50区间 + 缩量 + 价格未破10日均线 | 20%（总仓位≤80%） |


### 2. 卖出信号（优先级从高到低）
| 信号类型 | 触发条件 | 仓位建议 |
| --- | --- | --- |
| 顶背离确认 | 满足顶背离量化规则 + 50日均线趋势向上但斜率收窄（<0.5%） | 减仓50%→清仓（二次确认：价格破前高支撑） |
| 有效死叉 | 满足有效死叉规则 + 对应趋势验证 | 减仓40% |
| 超买回调 | RSI触及对应超买阈值 + 放量滞涨（有效放量）+ 价格未破50日均线上方3% | 减仓30% |
| 趋势反弹减仓 | 下降趋势中RSI反弹50-55区间 + 放量 + 价格未站上10日均线 | 减仓20%（总仓位≥30%） |


### 3. 止损止盈规则（量化落地）
| 操作类型 | 止损位设置 | 止盈位设置 |
| --- | --- | --- |
| 买入后止损 | 信号触发价 × (1 - 3%)（ETF）/ (1 - 5%)（杠杆ETF） | 信号触发价 × (1 + 5%)（震荡市）/ (1 + 8%)（牛市） |
| 卖出后止盈（空） | 信号触发价 × (1 + 3%)（ETF）/ (1 + 5%)（杠杆ETF） | 信号触发价 × (1 - 5%)（震荡市）/ (1 - 8%)（熊市） |
| 趋势破位止损 | 上升趋势：收盘价跌破50日均线×0.98；下降趋势：收盘价站上50日均线×1.02 | - |


## 五、回测层设计（验证策略有效性）
### 1. 回测框架核心参数
+ **回测周期**：2018-2025年（覆盖牛熊震荡全周期）；
+ **标的**：QQQ（基础）、TQQQ（杠杆）；
+ **手续费**：模拟实际交易成本（0.05%/次，含滑点）；
+ **仓位规则**：严格遵循信号层的仓位建议。

### 2. 绩效评估指标（金融+技术双维度）
| 指标类型 | 核心指标 | 合格标准 |
| --- | --- | --- |
| 收益指标 | 年化收益率、盈亏比 | 年化≥15%，盈亏比≥1.5 |
| 风险指标 | 最大回撤、夏普比率 | 最大回撤≤15%，夏普≥1.2 |
| 信号指标 | 胜率、假信号率 | 胜率≥62%，假信号率≤20% |


### 3. 参数敏感性测试
+ 测试维度：RSI周期（8/9/10日，23/24/25日）、超买超卖阈值（±5个点）、成交量倍数（1.1/1.2/1.3倍）；
+ 目标：找到不同市场环境下的最优参数组合，避免过拟合。

## 六、风控层设计（程序员+投资师双重风控）
### 1. 仓位风控
| 市场环境 | 单标的最大仓位 | 杠杆ETF仓位上限 | 加仓间隔 |
| --- | --- | --- | --- |
| 牛市 | 80% | 40% | ≥2个交易日 |
| 熊市 | 30% | 10% | ≥3个交易日 |
| 震荡市 | 50% | 20% | ≥1个交易日 |


### 2. 执行风控
+ **单日最大交易次数**：≤2次（避免频繁交易）；
+ **极端行情禁止**：VIX>30且RSI<10/RSI>90时，禁止开新仓；
+ **回撤风控**：累计回撤≥10%时，强制降仓至30%，暂停交易2个交易日。

### 3. 数据风控
+ 实时校验数据源完整性，数据延迟>5分钟时，暂停信号触发；
+ 每日收盘后复盘数据，修正当日异常数据（如停牌、跳空）。

## 七、监控与执行层设计（落地执行）
### 1. 实时监控模块
+ **监控维度**：50日均线趋势、实时成交量、9/24日RSI、价格点位、VIX指数；
+ **告警机制**：信号触发时推送（短信/邮件），异常数据时告警；
+ **可视化面板**：展示当前趋势、RSI位置、量能状态、持仓情况。

### 2. 执行逻辑
+ **半自动执行**：信号触发后人工确认，程序辅助计算止损止盈价；
+ **日志记录**：每笔交易记录「信号类型+触发条件+仓位+止损止盈+盈亏」，便于复盘；
+ **执行时效**：日线信号在次日开盘后15分钟内执行，30分钟线信号在信号触发后5分钟内执行。

## 八、迭代优化层设计（持续改进）
### 1. 周度复盘
+ 统计本周信号胜率、假信号原因（如量能未验证、趋势判断错误）；
+ 调整参数（如震荡市超买阈值从70→65）。

### 2. 季度优化
+ 基于最新市场环境（如波动率变化），重新校准RSI阈值、成交量倍数；
+ 回测近1年数据，验证策略有效性，调整规则（如新增VIX联动规则）。

### 3. 极端行情适配
+ 记录极端行情（如2020年3月、2024年7月）的信号表现，补充「极端行情禁止逆势」的量化规则。

## 核心设计原则总结
1. **金融逻辑优先**：所有代码逻辑必须严格贴合文档中NDX专属的RSI规则，拒绝脱离实战的纯量化拟合；
2. **分层解耦**：数据层、规则层、信号层、风控层独立设计，便于后续修改参数/规则；
3. **假信号过滤**：通过「趋势+量能+RSI」三重验证，过滤文档中提到的80%假信号；
4. **风控前置**：仓位、止损、极端行情禁止等规则嵌入信号触发前，而非执行后。

