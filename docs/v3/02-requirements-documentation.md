# 需求规格说明书（SRS / PRD）— v3 BRD 对齐修正版

**文档编号**：SRS-NDX-RSI-v3  
**文档版本**：3.0  
**产出日期**：2026-02-09  
**依据**：研发流程步骤 2 - 需求文档  
**参考规范**：IEEE 830-1998、ISO/IEC/IEEE 29148、FURPS+、需求可追溯性矩阵（RTM）  
**上游输入**：`v1/02-requirements-documentation.md`（v1 需求文档）、`context/brd.md`（业务规则文档）、代码实现差异分析  
**变更性质**：基于 BRD 与代码实现的逐条差异审计，修正和补充代码实现以与 BRD 完全对齐

---

## 1. 项目概述

### 1.1 背景

v1 版需求文档驱动的代码实现已完成基础骨架（RSI 双周期 + MA50 趋势 + 成交量分级 + 市场环境适配），但经逐条对比 BRD（`context/brd.md`）与代码实现，发现**信号确认条件、反向过滤逻辑、分趋势精细规则**等方面存在显著差距。本 v3 版需求文档聚焦于修正这些差距，使代码实现与 BRD 完全一致。

### 1.2 目标

- 修正和补充代码实现，使策略信号逻辑与 BRD 第三章「进阶版配合判断：分趋势精准适配」中的全部规则**逐条对齐**。
- 补齐缺失的信号确认条件、反向过滤逻辑和辅助指标。
- 修正已发现的逻辑冲突（如震荡市金叉的量能方向）。
- 保持已有架构不变（分层、配置化、可扩展），仅在信号层与风控层做修正和增强。

### 1.3 范围

| 维度 | 范围内 | 范围外 |
|------|--------|--------|
| 修正对象 | 信号组合逻辑（`combine.py`）、RSI 信号（`rsi_signals.py`）、趋势量能（`trend_volume.py`）、风控参数（`control.py`）、策略配置（`strategy.yaml`） | 数据层、回测引擎框架、CLI、架构调整 |
| 新增能力 | 5 日均线指标、强度分级超买超卖、反向过滤规则、信号级止损止盈、震荡市量能确认 | VIX 集成、周线级信号、权重股联动、K 线形态识别（标记为 Future） |
| 验证 | 回测对比（修正前后绩效指标）、规则覆盖率检查 | 实盘验证 |

---

## 2. 差异清单与功能需求

以下需求按差异严重程度排列（Critical → High → Medium），每条需求对应一个或多个 BRD 规则。

---

### 2.1 [Critical] 震荡市成交量确认缺失（FIX-01）

**差异描述**：BRD 明确"成交量是高低点确认键"，震荡市所有买卖信号需量能配合。代码中震荡市分支（`combine.py` 第 85-90 行）只判断 RSI 超买/超卖，**完全没有成交量验证**。

**BRD 原文规则**：

| RSI 信号 | 成交量条件 | 操作 |
|---|---|---|
| RSI 冲高 65-70（震荡超买） | 价格触 MA50 上沿 + **放量**（≥1.2x） | 减仓 30-40% |
| RSI 下探 30-35（震荡超卖） | 价格触 MA50 下方 + **缩量**（≤0.8x） | 加仓 30-40% |

**修正要求**：

1. 震荡市超买信号：需同时满足 `ob == True` **且** `vol_ratio >= 1.2`（放量确认抛压）才输出卖出。
2. 震荡市超卖信号：需同时满足 `os == True` **且** `vol_type == "down"`（缩量确认买盘）才输出买入。
3. 不满足成交量条件时，输出 `hold`（观望）。

**验收标准**：

- 震荡市中，RSI 超买但缩量时不产生卖出信号。
- 震荡市中，RSI 超卖但放量时不产生买入信号。
- 回测中震荡区间信号数量应减少（因增加了过滤条件）。

---

### 2.2 [Critical] 震荡市 RSI 阈值偏差（FIX-02）

**差异描述**：BRD 多处明确震荡市（NDX 专属）超买阈值为 **65**、超卖阈值为 **35**（"65 减 35 加"）。代码配置为 overbuy=70、oversell=30。

**BRD 原文**：
- "震荡量价定高低，**65 减 35 加**，假信号直接弃"
- "RSI 冲高 **65-70**（震荡超买）"、"RSI 下探 **30-35**（震荡超卖）"

**修正要求**：

1. 修改 `strategy.yaml` 中 `oscillate` 阈值：`overbuy: 65`，`oversell: 35`。
2. `transition` 阈值保持 `overbuy: 70`，`oversell: 30`（过渡期用通用值）。

**验收标准**：

- 震荡市环境下，RSI=66 即触发超买判断（原来需 RSI=70）。
- 震荡市环境下，RSI=34 即触发超卖判断（原来需 RSI=30）。

---

### 2.3 [Critical] 震荡市金叉/死叉量能方向冲突（FIX-03）

**差异描述**：代码对所有金叉/死叉统一要求 `vol_ratio >= 1.2`（放量）。但 BRD 规定**震荡市金叉要求缩量确认，死叉要求放量确认**，方向完全相反。

**BRD 原文**：

| 信号 | 有效条件 | 操作 |
|---|---|---|
| 金叉在 30-50 区间 + **缩量** | 信号有效 | 加仓 |
| 死叉在 50-70 区间 + **放量** | 信号有效 | 减仓 |
| 金叉在 50 以上 + 放量 | **假信号** | 忽略 |
| 死叉在 30 以下 + 缩量 | **假信号** | 忽略 |

**修正要求**：

1. 金叉/死叉的量能确认需**区分市场环境**：
   - 上升/下降趋势：维持现有逻辑（金叉+放量、死叉+放量）。
   - 震荡市：金叉有效需 `vol_type == "down"`（缩量），死叉有效需 `vol_ratio >= 1.2`（放量）。
2. 新增假信号过滤：
   - 震荡市中，金叉 midpoint > 50 且放量 → 忽略。
   - 震荡市中，死叉 midpoint < 30 且缩量 → 忽略。

**验收标准**：

- 震荡市中，金叉+放量不产生买入信号。
- 震荡市中，金叉+缩量+midpoint 在 30-50 区间产生买入信号。
- 假信号规则覆盖测试通过。

---

### 2.4 [Critical] 上升趋势放量下跌反向过滤缺失（FIX-04）

**差异描述**：BRD 明确上升趋势中 RSI 回踩 40-50 + **放量下跌** = "资金出逃，假支撑"，应**观望不加仓**。代码未实现此反向过滤。

**BRD 原文**：

> RSI 回踩 40-50 区间 + 放量下跌（成交量≥1.2 倍 20 日均量）→ 资金出逃，假支撑 → 观望，不加仓，等待缩量

**修正要求**：

1. 上升趋势中，当 RSI 处于 40-50（或触发超卖）且 `vol_ratio >= 1.2` 时，**禁止买入**，输出 `hold`。
2. 仅当 RSI 回踩 + **缩量**（`vol_type == "down"`）时才允许买入。
3. 同理，RSI 45-55 回踩加仓（第 74 行）也需增加"非放量"条件。

**验收标准**：

- 上升趋势中，RSI=43 + vol_ratio=1.3 → 输出 hold（非 buy）。
- 上升趋势中，RSI=43 + vol_ratio=0.7 → 输出 buy。

---

### 2.5 [Critical] 上升趋势放量超买应继续持仓（FIX-05）

**差异描述**：BRD 明确上升趋势中 RSI 超买 70-80 + **放量上涨** = "资金主动推涨，真超买" → **继续持仓，忽略超买**。代码虽隐式实现（仅缩量超买触发减仓），但缺少显式规则，易被后续维护误改。

**BRD 原文**：

> RSI 冲高 70-80 + 放量上涨（成交量≥1.2 倍）→ 资金主动推涨，真超买 → 继续持仓，忽略超买

**修正要求**：

1. 在上升趋势超买分支中，**显式判断**：若 `ob == True` 且 `vol_ratio >= 1.2`，返回 `hold`（reason: "overbought_with_volume_ignore"）。
2. 添加代码注释说明此规则来源（BRD 场景 1 第 4 行）。

**验收标准**：

- 上升趋势中，RSI=78 + vol_ratio=1.3 → 输出 hold（非 sell_light）。
- 上升趋势中，RSI=78 + vol_ratio=0.7 → 输出 sell_light -0.2。

---

### 2.6 [High] 下降趋势缩量反弹减仓缺失（FIX-06）

**差异描述**：BRD 规定下降趋势 RSI 反弹 50-60 + **缩量反弹** = "无量虚涨" → 轻仓减仓 20%。代码仅处理了放量场景（`vol_ratio >= 1.2` → sell -0.2），缩量场景无对应规则。

**BRD 原文**：

> RSI 反弹 50-60 区间 + 缩量反弹（成交量≤0.8 倍）→ 无量虚涨，假超买 → 轻仓减仓 20%，观望

**修正要求**：

1. 在下降趋势分支中新增规则：当 `50 <= rsi_s <= 60` 且 `vol_type == "down"` 时，输出 `sell_light`，position=-0.2，reason="trend_bounce_sell_light"。
2. 调整放量滞涨的仓位：`50 <= rsi_s <= 60` 且 `vol_ratio >= 1.2` → sell -0.4（BRD 原文为 40-50%），现有代码仅 -0.2 偏小。

**验收标准**：

- 下降趋势中，RSI=55 + vol_ratio=0.7 → 输出 sell_light -0.2。
- 下降趋势中，RSI=55 + vol_ratio=1.3 → 输出 sell -0.4。

---

### 2.7 [High] 金叉/死叉确认条件不完整（FIX-07）

**差异描述**：BRD 要求金叉/死叉需满足多项确认条件（缺一不可），代码仅检查交叉位置和成交量。

**BRD 原文（金叉有效确认）**：
1. 金叉位置：震荡市在 30-50 区间，牛市在 50 附近
2. 金叉后 RSI 双双站上 50，且价格站上 5 日均线
3. 成交量放大 ≥ 30%（即 vol_ratio ≥ 1.3）

**BRD 原文（无效信号过滤）**：
- 金叉在 70 以上 → 假信号，直接忽略
- 死叉在 30 以下 → 假信号，直接忽略

**修正要求**：

1. **新增 5 日均线指标**：在指标计算层新增 MA5（5 日均线）。
2. **金叉确认增强**：
   - 金叉后需 `rsi_short > 50` 且 `rsi_long > 50`（双双站上 50）。
   - 金叉后需 `close > ma5`（价格站上 5 日均线）。
   - 量能要求提升至 `vol_ratio >= 1.3`（≥30% 增幅），非趋势场景下。
3. **死叉确认增强**：
   - 死叉后需 `rsi_short < 50` 且 `rsi_long < 50`。
   - 死叉后需 `close < ma5`。
4. **无效信号过滤**：
   - 金叉 midpoint > 70 → 返回 None。
   - 死叉 midpoint < 30 → 返回 None。

**验收标准**：

- 金叉在 RSI=72 处产生时不触发信号。
- 金叉在 RSI=45 + 双 RSI 站上 50 + 价格>MA5 + 放量 ≥1.3x 时触发信号。
- 5 日均线计算结果与预期一致。

---

### 2.8 [High] 超买超卖缺少强度分级（FIX-08）

**差异描述**：BRD 定义了两级超买超卖（普通 vs 强），不同级别对应不同操作和仓位。代码只有单一阈值。

**BRD 原文阈值表**：

| 市场状态 | 超买 | 强超买 | 超卖 | 强超卖 |
|---|---|---|---|---|
| 震荡市 | 70 | 75 | 30 | 25 |
| 牛市 | 80 | 85 | 40 | 35 |
| 熊市 | 60 | 65 | 20 | 15 |

**修正要求**：

1. 在 `strategy.yaml` 中为每个市场环境增加 `strong_overbuy` 和 `strong_oversell` 阈值。
2. 修改 `check_overbought_oversold()` 返回值增加强度信息：`"overbought"` / `"strong_overbought"` / `"oversell"` / `"strong_oversell"`。
3. 在 `combine.py` 中根据强度分级调整仓位：
   - 普通超买 → 减仓（如 -0.2 ~ -0.3）
   - 强超买 → 加大减仓（如 -0.3 ~ -0.5）
   - 普通超卖 → 加仓（如 0.3）
   - 强超卖 → 加大加仓（如 0.4 ~ 0.5）

**验收标准**：

- 牛市中 RSI=82 判定为"强超买"，RSI=78 判定为"超买"。
- 强超买/强超卖对应更高的仓位调整幅度。

---

### 2.9 [High] 止损/止盈缺少信号级别差异化（FIX-09）

**差异描述**：BRD 针对不同信号类型规定不同止损幅度。代码统一使用 3% 止损、7% 止盈。

**BRD 原文**：

| 信号类型 | 止损 | 止盈 |
|---|---|---|
| 超买/超卖操作 | 信号价 ± 2-3% | RSI 回落/回升到中性区 |
| 背离/金叉操作 | 信号价 ± 3-5% | RSI 达目标阈值 |

**修正要求**：

1. 在风控计算中根据信号 `reason` 字段差异化止损/止盈比例：
   - `overbought` / `oversell` 类信号：stop_loss=2%，take_profit=5%。
   - `golden_cross` / `death_cross` 类信号：stop_loss=3%，take_profit=7%。
   - `bullish_divergence` / `bearish_divergence` 类信号：stop_loss=4%，take_profit=8%。
   - `trend_pullback` / `trend_bounce_sell` 类信号：stop_loss=3%，take_profit=6%。
2. 在 `strategy.yaml` 中配置各类信号对应的止损/止盈比例。

**验收标准**：

- 超买超卖信号的止损为 2%（非统一 3%）。
- 背离信号的止损为 4%。
- 回测中使用差异化止损。

---

### 2.10 [High] 背离信号未区分趋势场景（FIX-10）

**差异描述**：BRD 的背离信号在不同趋势下有完全不同的操作和量能要求。代码中背离信号不区分趋势，统一使用 `vol_ratio >= 0.8` 且仓位仅 0.25。

**BRD 原文**：

| 趋势 | 背离类型 | 量能条件 | 操作 |
|---|---|---|---|
| 上升 | 底背离 | 放量企稳（≥1.2x） | 加仓 **50%** |
| 下降 | 顶背离 | 缩量反弹（≤0.8x） | **清仓** |
| 下降 | 底背离 | — | 不操作（趋势可能延续） |
| 上升 | 顶背离 | — | 忽略（趋势可能延续） |

**修正要求**：

1. 将背离信号的处理从 `combine.py` 顶部移入各趋势分支中：
   - 上升趋势：只处理底背离（bullish_divergence），需 `vol_ratio >= 1.2`，仓位 0.5。
   - 下降趋势：只处理顶背离（bearish_divergence），需 `vol_type == "down"`，仓位 -1.0（清仓）。
   - 震荡市：底背离+缩量 → 买 0.3；顶背离+放量 → 卖 -0.3。
2. 上升趋势中忽略顶背离，下降趋势中忽略底背离。

**验收标准**：

- 上升趋势 + 底背离 + 放量 → buy 0.5。
- 上升趋势 + 顶背离 → hold（忽略）。
- 下降趋势 + 顶背离 + 缩量 → sell -1.0（清仓）。

---

### 2.11 [Medium] 平仓信号缺失（FIX-11）

**差异描述**：BRD 定义了明确的平仓条件（RSI 回落/回升到中性区），代码无此逻辑。

**BRD 原文**：
- "超买后 RSI 回落至 65 以下"→ 平仓
- "超卖后 RSI 回升至 35 以上"→ 平仓

**修正要求**：

1. 在信号生成中增加对持仓状态的感知（需传入当前持仓方向和入场 reason）。
2. 当持仓由超买信号进入且 RSI 回落至 65 以下时，生成平仓信号。
3. 当持仓由超卖信号进入且 RSI 回升至 35 以上时，生成平仓信号。

**验收标准**：

- 超买减仓后，RSI 从 75 降至 64 → 触发平仓信号。
- 超卖加仓后，RSI 从 25 升至 36 → 触发平仓信号。

---

### 2.12 [Medium] 动态仓位调整缺失（FIX-12）

**差异描述**：BRD 规定在特定 RSI 水平下应动态调整仓位上限（如牛市 RSI>80 时仓位从 80% 降至 50%）。代码仅有固定仓位上限。

**BRD 原文**：
- 牛市：最高仓位 80%，RSI>80 时降至 50%
- 熊市：最高仓位 30%，RSI<20 时升至 50%
- 震荡市：最高仓位 50%

**修正要求**：

1. 在 `apply_position_cap()` 中增加 RSI 水平判断：
   - 牛市 + RSI > 80 → cap 降至 0.5。
   - 熊市 + RSI < 20 → cap 升至 0.5。
2. 在 `strategy.yaml` 中配置动态 cap 规则。

**验收标准**：

- 牛市中 RSI=82 时，仓位上限为 50%（非 80%）。
- 熊市中 RSI=18 时，仓位上限为 50%（非 30%）。

---

### 2.13 [Medium] 20 日均线确认缺失（FIX-13）

**差异描述**：BRD 在多处提到 20 日均线作为趋势反转的确认条件，代码未计算 MA20。

**BRD 原文**：
- "RSI 站上 30 + 价格破 **20 日均线**，才视为趋势拐头"
- "下降趋势中轻仓试多的止损位设为 **20 日均线**下方 3%"

**修正要求**：

1. 在指标计算层新增 MA20（20 日均线）。
2. 在下降趋势的超卖买入信号中增加 MA20 确认：`close > ma20` 时信号增强，否则保持轻仓。
3. 止损计算可选使用 MA20 作为参考。

**验收标准**：

- MA20 计算结果正确。
- 下降趋势超卖 + 价格在 MA20 下方 → 仓位维持轻仓。

---

## 3. 配置变更需求

以下为 `strategy.yaml` 需要的配置修改和新增项：

```yaml
strategies:
  NDX_short_term:
    rsi_params:
      thresholds:
        bull:
          overbuy: 80
          strong_overbuy: 85      # [新增] 强超买
          oversell: 40
          strong_oversell: 35     # [新增] 强超卖
        bear:
          overbuy: 60
          strong_overbuy: 65
          oversell: 20
          strong_oversell: 15
        oscillate:
          overbuy: 65             # [修正] 原 70 → 65
          strong_overbuy: 70
          oversell: 35            # [修正] 原 30 → 35
          strong_oversell: 30
        transition:
          overbuy: 70
          strong_overbuy: 75
          oversell: 30
          strong_oversell: 25

    risk_control:
      # [新增] 信号级别差异化止损止盈
      signal_risk:
        overbought:
          stop_loss_ratio: 0.02
          take_profit_ratio: 0.05
        oversell:
          stop_loss_ratio: 0.02
          take_profit_ratio: 0.05
        golden_cross:
          stop_loss_ratio: 0.03
          take_profit_ratio: 0.07
        death_cross:
          stop_loss_ratio: 0.03
          take_profit_ratio: 0.07
        bullish_divergence:
          stop_loss_ratio: 0.04
          take_profit_ratio: 0.08
        bearish_divergence:
          stop_loss_ratio: 0.04
          take_profit_ratio: 0.08
        trend_pullback:
          stop_loss_ratio: 0.03
          take_profit_ratio: 0.06

      # [新增] 动态仓位上限
      dynamic_cap:
        bull:
          default: 0.8
          rsi_above_80: 0.5
        bear:
          default: 0.3
          rsi_below_20: 0.5
        oscillate:
          default: 0.5
```

---

## 4. 新增指标需求

| 指标 | 计算方式 | 用途 | 优先级 |
|------|----------|------|--------|
| MA5（5 日均线） | 收盘价 5 日简单移动平均 | 金叉/死叉确认（价格站上/跌破 MA5） | High |
| MA20（20 日均线） | 收盘价 20 日简单移动平均 | 熊市趋势反转确认、止损参考 | Medium |

---

## 5. 非功能需求

### 5.1 向后兼容（NFR-V3-01）

- 所有修正不改变现有接口签名和返回结构（`signal dict` 格式不变）。
- 新增字段（如 `strength`）为可选字段，不影响下游消费者。
- 配置文件新增项使用默认值，旧配置仍可运行。

### 5.2 可测试性（NFR-V3-02）

- 每条 FIX 需求需有对应单元测试。
- 测试用例覆盖 BRD 中每个场景的"操作"列和"纳指历史案例"列。
- 提供修正前后的回测对比报告。

### 5.3 可追溯性（NFR-V3-03）

- 代码注释中标注 BRD 规则来源（如 `# BRD 场景1 第2行：放量下跌不加仓`）。
- 每个信号的 `reason` 字段可追溯到具体 BRD 规则。

---

## 6. 约束条件

| 类型 | 约束内容 |
|------|----------|
| 架构 | 保持现有分层架构不变，修改限定在信号层（signal/）和风控层（risk/）|
| 配置 | 新增配置项需向后兼容，缺失时使用 v1 默认值 |
| 性能 | 新增 MA5、MA20 计算不应显著增加回测时间（<5% 开销）|
| 背离 | 背离信号默认仍为关闭（`use_divergence: false`），但修正后逻辑需正确 |

---

## 7. 验收标准汇总

| 需求 ID | 验收标准摘要 |
|---------|-------------|
| FIX-01 | 震荡市超买/超卖信号需量能确认；不满足则 hold |
| FIX-02 | 震荡市阈值为 65/35；配置修改后生效 |
| FIX-03 | 震荡市金叉需缩量、死叉需放量；假信号被过滤 |
| FIX-04 | 上升趋势放量下跌时禁止买入 |
| FIX-05 | 上升趋势放量超买时显式 hold |
| FIX-06 | 下降趋势缩量反弹 RSI 50-60 输出 sell_light |
| FIX-07 | 金叉需 MA5+双 RSI>50+vol≥1.3 确认；无效叉被过滤 |
| FIX-08 | 超买超卖有两级强度，对应不同仓位 |
| FIX-09 | 止损止盈按信号类型差异化 |
| FIX-10 | 背离信号区分趋势场景，仓位与 BRD 一致 |
| FIX-11 | RSI 回落/回升至中性区触发平仓信号 |
| FIX-12 | 仓位上限随 RSI 水平动态调整 |
| FIX-13 | MA20 计算正确，用于下降趋势确认 |

---

## 8. 需求优先级与实施建议

| 优先级 | 需求 | 影响范围 | 建议实施顺序 |
|--------|------|----------|-------------|
| **Critical** | FIX-01, FIX-02, FIX-03, FIX-04, FIX-05 | combine.py, strategy.yaml | 第 1 批 |
| **High** | FIX-06, FIX-07, FIX-08, FIX-09, FIX-10 | combine.py, rsi_signals.py, control.py, strategy.yaml, 新增 ma.py | 第 2 批 |
| **Medium** | FIX-11, FIX-12, FIX-13 | combine.py, ndx_short.py, 新增 ma.py | 第 3 批 |
| **Future** | VIX 集成、周线级信号、权重股联动、K 线形态 | 新模块 | v4+ |

---

## 9. 需求可追溯性矩阵（RTM）

| 本文需求 | BRD 来源章节 | 代码影响文件 | v1 SRS 关联 |
|----------|-------------|-------------|------------|
| FIX-01 | 三.场景 3 全部 | combine.py | FR-04 |
| FIX-02 | 二.1.2 超买超卖阈值分级 | strategy.yaml | FR-03 |
| FIX-03 | 三.场景 3 第 3-4 行 | combine.py | FR-04 |
| FIX-04 | 三.场景 1 第 2 行 | combine.py | FR-04 |
| FIX-05 | 三.场景 1 第 4 行 | combine.py | FR-04 |
| FIX-06 | 三.场景 2 第 2 行 | combine.py | FR-04 |
| FIX-07 | 二.四 金叉/死叉实操规则 | rsi_signals.py, combine.py | FR-04 |
| FIX-08 | 二.1.2 超买超卖阈值分级 | rsi_signals.py, strategy.yaml | FR-03, FR-04 |
| FIX-09 | 二.四 操作 + 四.2 止损设置 | control.py, strategy.yaml | FR-05 |
| FIX-10 | 三.场景 1/2 背离行 | combine.py | FR-04 |
| FIX-11 | 二.二 超买超卖实操阈值 | combine.py | FR-05 |
| FIX-12 | 四.2 仓位管理 | ndx_short.py, strategy.yaml | FR-05 |
| FIX-13 | 二.三 + 三.场景 2 | indicators/ma.py | FR-02 |

---

## 10. 术语表

沿用 v1 术语表，新增：

| 术语 | 英文 | 说明 |
|------|------|------|
| 强超买 | Strong Overbought | RSI 超过强超买阈值（如牛市 RSI>85），需更大幅度减仓 |
| 强超卖 | Strong Oversold | RSI 低于强超卖阈值（如熊市 RSI<15），可更大幅度加仓 |
| MA5 | 5-day Moving Average | 5 日均线，用于金叉/死叉的价格确认 |
| MA20 | 20-day Moving Average | 20 日均线，用于熊市趋势反转确认 |
| 反向过滤 | Counter-filter | 满足某些条件时禁止操作（如放量下跌禁止抄底） |
| 平仓信号 | Close Position Signal | RSI 回归中性区时触发的退出信号 |

---

## 11. 需求变更日志

| 版本 | 日期 | 变更说明 | 作者/来源 |
|------|------|----------|-----------|
| 1.0 | 2026-02-08 | 初版 SRS/PRD | v1 步骤 2 产出 |
| 3.0 | 2026-02-09 | BRD 对齐修正版：基于 BRD 与代码实现逐条差异审计，新增 13 条修正需求（FIX-01 ~ FIX-13），覆盖震荡市量能确认、阈值修正、金叉量能冲突、反向过滤、强度分级、信号级止损、背离分趋势、平仓信号、动态仓位、MA5/MA20 等 | v3 差异分析产出 |

---

**下一步**：本步骤完成后，请确认需求文档内容是否准确；确认后将进入后续技术方案调整和代码修改。
